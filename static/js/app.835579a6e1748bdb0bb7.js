webpackJsonp([1],{"+/7O":function(t,e,i){"use strict";e.a={props:["headers"]}},"+Sg+":function(t,e,i){"use strict";var n=i("iZiO"),a=i("u32G"),s=i("VU/8"),l=s(n.a,a.a,!1,null,null,null);e.a=l.exports},"556+":function(t,e,i){"use strict";var n=i("mtWM"),a=i.n(n),s=i("YaEn");e.a={user:{authenticated:!1},authenticate:function(t,e,i){var n=this;a.a.post("https://overtinvest-test.herokuapp.com/api/v1/auth",e).then(function(e){var a=e.data;t.$cookie.set("token",a.token,"1D"),t.$cookie.set("user_id",a.user._id,"1D"),t.validLogin=!0,n.user.authenticated=!0,i&&s.a.push(i)}).catch(function(e){var i=e.response.data;t.snackbar=!0,t.message=i.message})},signup:function(t,e,i){var n=this;a.a.post("https://overtinvest-test.herokuapp.com/api/v1/signup",e).then(function(){t.validSignUp=!0,n.authenticate(t,e,i)}).catch(function(e){var i=e.response.data;t.snackbar=!0,t.message=i.message})},signout:function(t,e){t.$cookie.delete("token"),t.$cookie.delete("user_id"),this.user.authenticated=!1,e&&s.a.push(e)},checkAuthentication:function(){var t=document.cookie;this.user.authenticated=!!t},getAuthenticationHeader:function(t){return"Bearer "+t.$cookie.get("token")}}},"5UxW":function(t,e){},"5aYr":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("header",{staticClass:"l-list-header"},t._l(t.headers,function(e){return null!=t.headers?i("div",{staticClass:"md-list-header white--text"},[t._v("\n      "+t._s(e)+"\n  ")]):t._e()}))},a=[],s={render:n,staticRenderFns:a};e.a=s},"5cIJ":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"l-client-creation"},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",md4:""}},[i("v-text-field",{attrs:{label:"Название",required:"",color:"green lighten-1"},model:{value:t.client.name,callback:function(e){t.$set(t.client,"name",e)},expression:"client.name"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md3:"","offset-md1":""}},[i("v-text-field",{attrs:{label:"Email",required:"",color:"green lighten-1"},model:{value:t.client.email,callback:function(e){t.$set(t.client,"email",e)},expression:"client.email"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md3:"","offset-md1":""}},[i("v-text-field",{attrs:{label:"Телефон",required:"",mask:"phone",color:"green lighten-1"},model:{value:t.client.phone,callback:function(e){t.$set(t.client,"phone",e)},expression:"client.phone"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("v-btn",{attrs:{block:"",color:"md-add-item-btn green lighten-1"},nativeOn:{click:function(e){t.updateClient(t.client)}}},[t._v("Обновить")])],1)],1)],1)},a=[],s={render:n,staticRenderFns:a};e.a=s},"6phz":function(t,e,i){"use strict";function n(t){i("GuyU")}var a=i("+/7O"),s=i("5aYr"),l=i("VU/8"),r=n,c=l(a.a,s.a,!1,r,null,null);e.a=c.exports},"7NQB":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"l-budget-creation"},[i("v-layout",{attrs:{row:"",wrap:""}},[i("span",{staticClass:"md-budget-state-hint uppercased white--text"}),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:""}},[i("v-select",{attrs:{label:"Тип",items:t.states},model:{value:t.budget.state,callback:function(e){t.$set(t.budget,"state",e)},expression:"budget.state"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md9:"","offset-md1":""}},[i("v-select",{attrs:{label:"Производитель",items:t.clients,"item-text":"name","item-value":"_id"},model:{value:t.budget.client_id,callback:function(e){t.$set(t.budget,"client_id",e)},expression:"budget.client_id"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md12:""}},[i("v-text-field",{attrs:{label:"Название",required:"",color:"light-blue lighten-1"},model:{value:t.budget.title,callback:function(e){t.$set(t.budget,"title",e)},expression:"budget.title"}}),t._v(" "),i("v-text-field",{attrs:{label:"Описание",textarea:"",required:"",color:"light-blue lighten-1"},model:{value:t.budget.description,callback:function(e){t.$set(t.budget,"description",e)},expression:"budget.description"}}),t._v(" "),i("v-text-field",{attrs:{label:"Ожидаемый доход",box:"",dark:"",prefix:"%",required:"",color:"light-blue lighten-1"},model:{value:t.budget.profit,callback:function(e){t.$set(t.budget,"profit",e)},expression:"budget.profit"}})],1),t._v(" "),t._l(t.budget.items,function(e){return i("v-layout",{key:e.id,staticClass:"l-budget-item",attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",md1:""}},[i("v-btn",{attrs:{block:"",dark:"",color:"red lighten-1"},nativeOn:{click:function(i){t.removeItem(e)}}},[t._v("Удалить")])],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md3:"","offset-md1":""}},[i("v-text-field",{attrs:{label:"Название",box:"",dark:"",required:"",color:"light-blue lighten-1"},model:{value:e.title,callback:function(i){t.$set(e,"title",i)},expression:"item.title"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md1:"","offset-md1":""}},[i("v-text-field",{attrs:{label:"Сумма",box:"",dark:"",prefix:"$",required:"",color:"light-blue lighten-1"},model:{value:e.price,callback:function(i){t.$set(e,"price",i)},expression:"item.price"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md1:"","offset-md1":""}},[i("v-text-field",{attrs:{label:"Количество",box:"",dark:"",min:"0",type:"number",required:"",color:"light-blue lighten-1"},model:{value:e.quantity,callback:function(i){t.$set(e,"quantity",i)},expression:"item.quantity"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:""}},[i("span",{staticClass:"md-budget-item-subtotal white--text"},[t._v("себестоимость "+t._s(e.subtotal))])])],1)}),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("v-btn",{attrs:{block:"",color:"md-add-item-btn light-blue lighten-1"},nativeOn:{click:function(e){t.addItem()}}},[t._v("Добавить")])],1),t._v(" "),t._l(t.budget.calcs,function(e){return i("v-layout",{key:e.id,staticClass:"l-budget-item",attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",md1:""}},[i("v-btn",{attrs:{block:"",dark:"",color:"red lighten-1"},nativeOn:{click:function(i){t.removeCalc(e)}}},[t._v("Удалить")])],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md3:"","offset-md1":""}},[i("v-select",{attrs:{label:"Производство",items:t.budgets,"item-text":"title","item-value":"_id"},model:{value:e._id,callback:function(i){t.$set(e,"_id",i)},expression:"item._id"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:""}},[i("span",{staticClass:"md-budget-item-subtotal white--text"},[t._v("cуммарные расходы "+t._s(e.budget_item(e._id,t.budgets,"total_price")))])]),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:""}},[i("span",{staticClass:"md-budget-item-subtotal white--text"},[t._v("прибыль "+t._s(e.budget_item(e._id,t.budgets,"profit")))])]),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:""}},[i("span",{staticClass:"md-budget-item-subtotal white--text"},[t._v("итоговая цена "+t._s(+e.budget_item(e._id,t.budgets,"total_price")/100*(+e.budget_item(e._id,t.budgets,"profit")+100)))])])],1)}),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("v-btn",{attrs:{block:"",color:"md-add-item-btn light-blue lighten-1"},nativeOn:{click:function(e){t.addCalc()}}},[t._v("Добавить")])],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("span",{staticClass:"md-budget-item-total white--text"},[t._v("Себестоимость "+t._s(t.budget.total_price))])]),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("span",{staticClass:"md-budget-item-total white--text"},[t._v("Итоговая цена "+t._s(t.budget.total_revenue))])]),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("v-btn",{attrs:{block:"",color:"md-add-item-btn green lighten-1"},nativeOn:{click:function(e){t.fixClientNameAndUpdate(t.budget)}}},[t._v("Обновить")])],1)],2)],1)},a=[],s={render:n,staticRenderFns:a};e.a=s},"7Ze7":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-app",[i("v-container",[i("router-view")],1)],1)},a=[],s={render:n,staticRenderFns:a};e.a=s},A2gB:function(t,e){},Ai6D:function(t,e,i){"use strict";function n(t){i("e3+7")}var a=i("DLRC"),s=i("m1TP"),l=i("VU/8"),r=n,c=l(a.a,s.a,!1,r,null,null);e.a=c.exports},"D+jH":function(t,e,i){"use strict";function n(t){i("NW75")}var a=i("MIJR"),s=i("caWb"),l=i("VU/8"),r=n,c=l(a.a,s.a,!1,r,null,null);e.a=c.exports},DLRC:function(t,e,i){"use strict";e.a={props:["data","budgetsVisible","deleteItem","getBudget","getClient","parsedBudgets"],methods:{getItemAndEdit:function(t){t.phone?this.getClient(t):this.getBudget(t)}}}},GQ84:function(t,e){},GuyU:function(t,e){},HCTz:function(t,e,i){"use strict";var n=i("556+");e.a={props:["budgetsVisible","selectState","search"],data:function(){return{searchValue:"",status:"",statusItems:["плановая","фактическая","нормативная","сметная","цеховая","полная"]}},watch:{searchValue:function(){this.$emit("input",this.searchValue)}},created:function(){this.searchValue=this.search},methods:{submitSignout:function(){n.a.signout(this,"/login")}}}},I2Tb:function(t,e,i){"use strict";function n(t){i("RKRT")}var a=i("PouT"),s=i("ficY"),l=i("VU/8"),r=n,c=l(a.a,s.a,!1,r,null,null);e.a=c.exports},"K/lz":function(t,e,i){"use strict";function n(t){i("u4bJ")}var a=i("w20z"),s=i("5cIJ"),l=i("VU/8"),r=n,c=l(a.a,s.a,!1,r,null,null);e.a=c.exports},Kl4h:function(t,e){},LE3h:function(t,e,i){"use strict";function n(t){i("Kl4h")}var a=i("QTHo"),s=i("uRV1"),l=i("VU/8"),r=n,c=l(a.a,s.a,!1,r,null,null);e.a=c.exports},M93x:function(t,e,i){"use strict";function n(t){i("GQ84")}var a=i("xJD8"),s=i("7Ze7"),l=i("VU/8"),r=n,c=l(a.a,s.a,!1,r,null,null);e.a=c.exports},MIJR:function(t,e,i){"use strict";e.a={props:["clients","budgets","saveBudget"],data:function(){var t=this.budgets;return{budget:{title:null,description:null,profit:0,state:"плановая",client:null,get total_price(){var e=0;return this.items.forEach(function(t){var i=t.subtotal;e+=parseInt(i)}),this.calcs.forEach(function(i){e+=+i.budget_item(i._id,t,"total_price")/100*(+i.budget_item(i._id,t,"profit")+100)}),e.toFixed(6)},get total_revenue(){return(this.total_price/100*(+Math.abs(this.profit)+100)).toFixed(6)},items:[{title:null,quantity:0,price:0,budgets:null,get subtotal(){return this.quantity*this.price}}],calcs:[{_id:"",budget_item:function(t,e,i){console.log(e);var n=e.filter(function(e){return e._id===t}),a=n[0]?n[0][i]:0;return console.log("result[0] ",a),a}}]},states:["плановая","фактическая","нормативная","сметная","цеховая","полная"]}},methods:{addItem:function(){var t=this.budget.items,e={title:"",budgets:null,quantity:0,price:0,get subtotal(){return this.quantity*this.price}};t.push(e)},removeItem:function(t){var e=this.budget.items;e.forEach(function(i,n){i===t&&e.splice(n,1)})},addCalc:function(){var t=this.budget.calcs,e={_id:"",budget_item:function(t,e,i){console.log(e);var n=e.filter(function(e){return e._id===t}),a=n[0]?n[0][i]:0;return console.log("result[0] ",a),a}};t.push(e)},removeCalc:function(t){var e=this.budget.calcs;e.forEach(function(i,n){i===t&&e.splice(n,1)})}}}},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/5sW"),a=i("M93x"),s=i("YaEn"),l=i("K/Lq"),r=i.n(l),c=i("3EgV"),o=i.n(c),u=i("556+");i.e(0).then(i.bind(null,"7zck")),n.a.use(r.a),n.a.use(o.a),n.a.config.productionTip=!1,u.a.checkAuthentication(),new n.a({el:"#app",router:s.a,render:function(t){return t(a.a)}})},NW75:function(t,e){},PouT:function(t,e,i){"use strict";var n=i("mtWM"),a=i.n(n),s=i("556+"),l=i("6phz"),r=i("Ai6D"),c="https://overtinvest-test.herokuapp.com";e.a={components:{"list-header":l.a,"list-body":r.a},data:function(){return{parsedBudgets:null,budget:null,client:null,state:null,search:null,budgets:[],clients:[],budgetHeaders:["Производство","Калькуляция","Тип","Действия"],clientHeaders:["Название","Почта","Телефон","Действия"],budgetsVisible:!0,snackbar:!1,timeout:6e3,message:"",fab:!1,listPage:!0,createPage:!1,editPage:!1,budgetCreation:!0,budgetEdit:!0,snackColor:"red lighten-1"}},mounted:function(){this.getAllBudgets(),this.getAllClients(),this.hidden=!1},watch:{search:function(){if(null!==this.search||""!==this.search){var t=this.search,e=new RegExp("^("+t+")","g"),i=this.budgets.filter(function(t){return t.client.match(e)});this.parsedBudgets=i}else this.parsedBudgets=null}},methods:{getAllBudgets:function(){var t=this;a.a.get(c+"/api/v1/budget",{headers:{Authorization:s.a.getAuthenticationHeader(this)},params:{user_id:this.$cookie.get("user_id")}}).then(function(e){var i=e.data;t.budgets=t.dataParser(i,"_id","client","title","state","client_id","total_price","profit")}).catch(function(e){t.errorHandler(e)})},getAllClients:function(){var t=this;a.a.get(c+"/api/v1/client",{headers:{Authorization:s.a.getAuthenticationHeader(this)},params:{user_id:this.$cookie.get("user_id")}}).then(function(e){var i=e.data;t.clients=t.dataParser(i,"name","email","_id","phone")}).catch(function(e){t.errorHandler(e)})},getBudget:function(t){var e=this;a.a.get(c+"/api/v1/budget/single",{headers:{Authorization:s.a.getAuthenticationHeader(this)},params:{user_id:this.$cookie.get("user_id"),_id:t._id}}).then(function(t){var i=t.data;e.budget=i,e.enableEdit("budget")}).catch(function(t){e.errorHandler(t)})},getClient:function(t){var e=this;a.a.get(c+"/api/v1/client/single",{headers:{Authorization:s.a.getAuthenticationHeader(this)},params:{user_id:this.$cookie.get("user_id"),_id:t._id}}).then(function(t){var i=t.data;e.client=i,e.enableEdit("client")}).catch(function(t){e.errorHandler(t)})},enableEdit:function(t){"budget"===t?(this.listPage=!1,this.budgetEdit=!0,this.budgetCreation=!1,this.editPage=!0):"client"===t&&(this.listPage=!1,this.budgetEdit=!1,this.budgetCreation=!1,this.editPage=!0)},saveBudget:function(t){var e=this;a.a.post(c+"/api/v1/budget",t,{headers:{Authorization:s.a.getAuthenticationHeader(this)},params:{user_id:this.$cookie.get("user_id")}}).then(function(i){e.resetFields(t),e.snackbar=!0,e.message=i.data.message,e.snackColor="green lighten-1",e.getAllBudgets()}).catch(function(t){e.errorHandler(t)})},fixClientNameAndUpdate:function(t){this.clients.find(function(e){e._id===t.client_id&&(t.client=e.name)}),this.updateBudget(t)},updateBudget:function(t){var e=this;a.a.put(c+"/api/v1/budget/single",t,{headers:{Authorization:s.a.getAuthenticationHeader(this)},params:{user_id:this.$cookie.get("user_id")}}).then(function(){e.snackbar=!0,e.message="Budget updated",e.snackColor="green lighten-1",e.listPage=!0,e.budgetCreation=!1,e.budgetsVisible=!0,e.getAllBudgets()}).catch(function(t){e.errorHandler(t)})},updateClient:function(t){var e=this;a.a.put(c+"/api/v1/client/single",t,{headers:{Authorization:s.a.getAuthenticationHeader(this)},params:{user_id:this.$cookie.get("user_id")}}).then(function(){e.snackbar=!0,e.message="Client updated",e.snackColor="green lighten-1",e.listPage=!0,e.budgetCreation=!1,e.budgetsVisible=!1,e.getAllClients()}).catch(function(t){e.errorHandler(t)})},saveClient:function(t){var e=this;a.a.post(c+"/api/v1/client",t,{headers:{Authorization:s.a.getAuthenticationHeader(this)},params:{user_id:this.$cookie.get("user_id")}}).then(function(i){e.resetFields(t),e.snackbar=!0,e.message=i.data.message,e.snackColor="green lighten-1",e.getAllClients()}).catch(function(t){e.errorHandler(t)})},deleteItem:function(t,e,i){var n=this,l="";l=i?"budget":"client",a.a.delete(c+"/api/v1/"+l,{headers:{Authorization:s.a.getAuthenticationHeader(this)},params:{user_id:this.$cookie.get("user_id"),_id:t._id}}).then(function(){n.removeItem(t,e)}).then(function(){i?n.getAllBudgets():n.getAllClients()}).catch(function(t){n.errorHandler(t)})},errorHandler:function(t){var e=t.response.status;this.snackbar=!0,this.snackColor="red lighten-1",this.message=404===e?"Invalid request":401===e||403===e?"Unauthorized":400===e?"Invalid or missing information":t.message},removeItem:function(t,e){e.forEach(function(i,n){i===t&&e.splice(n,1)})},dataParser:function(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];var a=[];return t.forEach(function(t){var e={};i.forEach(function(i){return e[i]=t[i]}),a.push(e)}),a},resetFields:function(t){for(var e in t)t[e]=null,"quantity"!==e&&"price"!==e||(t[e]=0),t.items=[]},selectState:function(t){this.state=t,"all"===t?this.getAllBudgets():this.getBudgetsByState(t)},getBudgetsByState:function(t){var e=this;a.a.get(c+"/api/v1/budget/state",{headers:{Authorization:s.a.getAuthenticationHeader(this)},params:{user_id:this.$cookie.get("user_id"),state:t}}).then(function(t){var i=t.data;e.budgets=e.dataParser(i,"_id","client","title","state","client_id")}).catch(function(t){e.errorHandler(t)})}}}},QTHo:function(t,e,i){"use strict";var n=i("556+");e.a={data:function(){return{snackbar:!1,validLogin:!1,validSignUp:!1,signUpVisible:!1,loginPasswordVisible:!1,signUpPasswordVisible:!1,timeout:6e3,rules:[function(t){return!!t||"This field is required"}],credentials:{username:"",password:""},newUser:{username:"",password:""},message:""}},methods:{submitAuthentication:function(){n.a.authenticate(this,this.credentials,"/")},submitSignUp:function(){n.a.signup(this,this.newUser,"/")}}}},RKRT:function(t,e){},YaEn:function(t,e,i){"use strict";var n=i("/5sW"),a=i("/ocq"),s=i("556+"),l=i("I2Tb"),r=i("LE3h"),c=i("teIl"),o=i("wWYc"),u=i("+Sg+");n.a.component("app-header",c.a),n.a.component("list",o.a),n.a.component("create",u.a),n.a.use(a.a);var d=new a.a({routes:[{path:"/",name:"Home",components:{default:l.a,header:c.a,list:o.a,create:u.a}},{path:"/login",name:"Authentication",component:r.a}]});d.beforeEach(function(t,e,i){"/login"!==t.path?s.a.user.authenticated?i():d.push("/login"):i()}),e.a=d},aVU9:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement;return(t._self._c||e)("section",{staticClass:"l-list-container"},[t._t("list-header"),t._v(" "),t._t("list-body")],2)},a=[],s={render:n,staticRenderFns:a};e.a=s},caWb:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"l-budget-creation"},[i("v-layout",{attrs:{row:"",wrap:""}},[i("span",{staticClass:"md-budget-state-hint uppercased white--text"},[t._v("status")]),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:""}},[i("v-select",{attrs:{label:"Тип",items:t.states},model:{value:t.budget.state,callback:function(e){t.$set(t.budget,"state",e)},expression:"budget.state"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md9:"","offset-md1":""}},[i("v-select",{attrs:{label:"Производство",items:t.clients,"item-text":"name","item-value":"_id"},model:{value:t.budget.client,callback:function(e){t.$set(t.budget,"client",e)},expression:"budget.client"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md12:""}},[i("v-text-field",{attrs:{label:"Название",required:"",color:"light-blue lighten-1"},model:{value:t.budget.title,callback:function(e){t.$set(t.budget,"title",e)},expression:"budget.title"}}),t._v(" "),i("v-text-field",{attrs:{label:"Описание",textarea:"",required:"",color:"light-blue lighten-1"},model:{value:t.budget.description,callback:function(e){t.$set(t.budget,"description",e)},expression:"budget.description"}}),t._v(" "),i("v-text-field",{attrs:{label:"Ожидаемый доход",box:"",dark:"",prefix:"%",required:"",color:"light-blue lighten-1"},model:{value:t.budget.profit,callback:function(e){t.$set(t.budget,"profit",e)},expression:"budget.profit"}})],1),t._v(" "),t._l(t.budget.items,function(e){return i("v-layout",{key:e.id,staticClass:"l-budget-item",attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",md1:""}},[i("v-btn",{attrs:{block:"",dark:"",color:"red lighten-1"},nativeOn:{click:function(i){t.removeItem(e)}}},[t._v("Удалить")])],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md3:"","offset-md1":""}},[i("v-text-field",{attrs:{label:"Название",box:"",dark:"",required:"",color:"light-blue lighten-1"},model:{value:e.title,callback:function(i){t.$set(e,"title",i)},expression:"item.title"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md1:"","offset-md1":""}},[i("v-text-field",{attrs:{label:"Сумма",box:"",dark:"",prefix:"$",required:"",color:"light-blue lighten-1"},model:{value:e.price,callback:function(i){t.$set(e,"price",i)},expression:"item.price"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md1:"","offset-md1":""}},[i("v-text-field",{attrs:{label:"Количество",box:"",dark:"",min:"0",type:"number",required:"",color:"light-blue lighten-1"},model:{value:e.quantity,callback:function(i){t.$set(e,"quantity",i)},expression:"item.quantity"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:""}},[i("span",{staticClass:"md-budget-item-subtotal white--text"},[t._v("себестоимость "+t._s(e.subtotal))])])],1)}),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("v-btn",{attrs:{block:"",color:"md-add-item-btn light-blue lighten-1"},nativeOn:{click:function(e){t.addItem()}}},[t._v("Добавить")])],1),t._v(" "),t._l(t.budget.calcs,function(e){return i("v-layout",{key:e.id,staticClass:"l-budget-item",attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",md1:""}},[i("v-btn",{attrs:{block:"",dark:"",color:"red lighten-1"},nativeOn:{click:function(i){t.removeCalc(e)}}},[t._v("Удалить")])],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md3:"","offset-md1":""}},[i("v-select",{attrs:{label:"Производитель",items:t.budgets,"item-text":"title","item-value":"_id"},model:{value:e._id,callback:function(i){t.$set(e,"_id",i)},expression:"item._id"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:""}},[i("span",{staticClass:"md-budget-item-subtotal white--text"},[t._v("cуммарные расходы "+t._s(e.budget_item(e._id,t.budgets,"total_price")))])]),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:""}},[i("span",{staticClass:"md-budget-item-subtotal white--text"},[t._v("прибыль "+t._s(e.budget_item(e._id,t.budgets,"profit")))])]),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:""}},[i("span",{staticClass:"md-budget-item-subtotal white--text"},[t._v("итоговая цена "+t._s(+e.budget_item(e._id,t.budgets,"total_price")/100*(+e.budget_item(e._id,t.budgets,"profit")+100)))])])],1)}),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("v-btn",{attrs:{block:"",color:"md-add-item-btn light-blue lighten-1"},nativeOn:{click:function(e){t.addCalc()}}},[t._v("Добавить")])],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("span",{staticClass:"md-budget-item-total white--text"},[t._v("Себестоимость "+t._s(t.budget.total_price))])]),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("span",{staticClass:"md-budget-item-total white--text"},[t._v("Итоговая цена "+t._s(t.budget.total_revenue))])]),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("v-btn",{attrs:{block:"",color:"md-add-item-btn green lighten-1"},nativeOn:{click:function(e){t.saveBudget(t.budget)}}},[t._v("Сохранить")])],1)],2)],1)},a=[],s={render:n,staticRenderFns:a};e.a=s},"e3+7":function(t,e){},eCfQ:function(t,e,i){"use strict";e.a={props:["clients","budgets","fixClientNameAndUpdate","selectedBudget"],data:function(){var t=this.budgets;return{budget:{title:null,description:null,profit:10,state:"плановая",client:null,get total_price(){var e=0;return this.items.forEach(function(t){var i=(t.state,t.subtotal);e+=parseInt(i)}),this.calcs.forEach(function(i){e+=+i.budget_item(i._id,t,"total_price")/100*(+i.budget_item(i._id,t,"profit")+100)}),e.toFixed(6)},get total_revenue(){return(this.total_price/100*(+Math.abs(this.profit)+100)).toFixed(6)},items:[{title:null,quantity:0,price:0,budgets:null,get subtotal(){return this.quantity*this.price}}],calcs:[{_id:"",budget_item:function(t,e,i){console.log(e);var n=e.filter(function(e){return e._id===t}),a=n[0]?n[0][i]:0;return console.log("result[0] ",a),a}}]},states:["плановая","фактическая","нормативная","сметная","цеховая","полная"]}},mounted:function(){this.parseBudget()},methods:{addItem:function(){var t=this.budget.items,e={title:"",state:"прибыль",quantity:0,price:0,get subtotal(){return this.quantity*this.price}};t.push(e)},removeItem:function(t){var e=this.budget.items;e.forEach(function(i,n){i===t&&e.splice(n,1)})},addCalc:function(){var t=this.budget.calcs,e={_id:"",budget_item:function(t,e,i){console.log(e);var n=e.filter(function(e){return e._id===t}),a=n[0]?n[0][i]:0;return console.log("result[0] ",a),a}};t.push(e)},removeCalc:function(t){var e=this.budget.calcs;e.forEach(function(i,n){i===t&&e.splice(n,1)})},parseBudget:function(){var t=this;for(var e in this.selectedBudget)"total"!==e&&"items"!==e&&(this.budget[e]=this.selectedBudget[e]),"items"===e&&function(){var e=t.selectedBudget.items,i=function(t){return{title:t.title,quantity:t.quantity,price:t.price,get subtotal(){return this.quantity*this.price}}};t.budget.items=function(t){return t.map(i)}(e)}(),"calcs"===e&&function(){var e=t.selectedBudget.calcs,i=function(t){return{_id:t,budget_item:function(t,e,i){console.log(e);var n=e.filter(function(e){return e._id===t}),a=n[0]?n[0][i]:0;return console.log("result[0] ",a),a}}},n=function(t){return t.map(i)};console.log(n(e)),t.budget.calcs=n(e)}()}}}},ficY:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("main",{staticClass:"l-home-page"},[i("app-header",{attrs:{budgetsVisible:t.budgetsVisible,selectState:t.selectState,search:t.search},on:{toggleVisibleData:function(e){t.budgetsVisible=!t.budgetsVisible,t.budgetCreation=!t.budgetCreation}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),i("div",{staticClass:"l-home"},[i("h4",{staticClass:"white--text text-xs-center my-0"},[t._v("\n      Расчет себестоимости\n    ")]),t._v(" "),t.listPage?i("list",[i("list-header",{attrs:{slot:"list-header",headers:t.budgetsVisible?t.budgetHeaders:t.clientHeaders},slot:"list-header"}),t._v(" "),i("list-body",{attrs:{slot:"list-body",budgetsVisible:t.budgetsVisible,data:t.budgetsVisible?t.budgets:t.clients,search:t.search,deleteItem:t.deleteItem,getBudget:t.getBudget,getClient:t.getClient,parsedBudgets:t.parsedBudgets},slot:"list-body"})],1):t.createPage?i("create",{attrs:{budgetCreation:t.budgetCreation,budgetEdit:t.budgetEdit,editPage:t.editPage,clients:t.clients,budgets:t.budgets,budget:t.budget,client:t.client,saveBudget:t.saveBudget,saveClient:t.saveClient,fixClientNameAndUpdate:t.fixClientNameAndUpdate,updateClient:t.updateClient}}):t._e()],1),t._v(" "),i("v-snackbar",{attrs:{timeout:t.timeout,bottom:"bottom",color:t.snackColor},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n    "+t._s(t.message)+"\n  ")]),t._v(" "),i("v-fab-transition",[i("v-speed-dial",{attrs:{bottom:"",right:"",fixed:"",direction:"top",transition:"scale-transition"},model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[i("v-btn",{attrs:{slot:"activator",color:"red lighten-1",dark:"",fab:""},slot:"activator",model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[i("v-icon",[t._v("add")]),t._v(" "),i("v-icon",[t._v("close")])],1),t._v(" "),i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",color:"light-blue lighten-1",dark:"",small:"",fab:""},nativeOn:{click:function(e){t.budgetCreation=!0,t.listPage=!1,t.editPage=!1,t.createPage=!0}},slot:"activator"},[i("v-icon",[t._v("assignment")])],1),t._v(" "),i("span",[t._v("Добавить калькуляцию")])],1),t._v(" "),i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",color:"green lighten-1",dark:"",small:"",fab:""},nativeOn:{click:function(e){t.budgetCreation=!1,t.listPage=!1,t.editPage=!1,t.createPage=!0}},slot:"activator"},[i("v-icon",[t._v("account_circle")])],1),t._v(" "),i("span",[t._v("Добавить производство")])],1),t._v(" "),i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",color:"purple lighten-2",dark:"",small:"",fab:""},nativeOn:{click:function(e){t.budgetCreation=!1,t.listPage=!0,t.budgetsVisible=!0}},slot:"activator"},[i("v-icon",[t._v("assessment")])],1),t._v(" "),i("span",[t._v("Список калькуляций")])],1),t._v(" "),i("v-tooltip",{attrs:{left:""}},[i("v-btn",{attrs:{slot:"activator",color:"deep-orange lighten-2",dark:"",small:"",fab:""},nativeOn:{click:function(e){t.budgetCreation=!1,t.listPage=!0,t.budgetsVisible=!1}},slot:"activator"},[i("v-icon",[t._v("supervisor_account")])],1),t._v(" "),i("span",[t._v("Список производств")])],1)],1)],1)],1)},a=[],s={render:n,staticRenderFns:a};e.a=s},g0Ki:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("header",{staticClass:"l-header-container"},[i("v-layout",{class:t.budgetsVisible?"l-budgets-header":"l-clients-header",attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",md4:""}},[i("v-text-field",{attrs:{label:"Поиск","append-icon":"search",color:t.budgetsVisible?"light-blue lighten-1":"green lighten-1"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"","offset-md1":"",md2:""}},[i("v-btn",{attrs:{block:"",color:t.budgetsVisible?"light-blue lighten-1":"green lighten-1"},nativeOn:{click:function(e){t.$emit("toggleVisibleData")}}},[t._v("\n             "+t._s(t.budgetsVisible?"Производства":"Калькуляции")+"\n      ")])],1),t._v(" "),i("v-flex",{attrs:{xs12:"","offset-md1":"",md2:""}},[i("v-select",{attrs:{label:"Тип",color:t.budgetsVisible?"light-blue lighten-1":"green lighten-1",items:t.statusItems,"single-line":""},on:{change:t.selectState},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"","offset-md1":"",md1:""}},[i("v-btn",{attrs:{block:"",color:"red lighten-1 white--text"},nativeOn:{click:function(e){t.submitSignout()}}},[t._v("Выход")])],1)],1)],1)},a=[],s={render:n,staticRenderFns:a};e.a=s},heOt:function(t,e,i){"use strict";e.a={}},i1Wc:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"l-client-creation"},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs12:"",md4:""}},[i("v-text-field",{attrs:{label:"Название",required:"",color:"green lighten-1"},model:{value:t.client.name,callback:function(e){t.$set(t.client,"name",e)},expression:"client.name"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md3:"","offset-md1":""}},[i("v-text-field",{attrs:{label:"Email",required:"",color:"green lighten-1"},model:{value:t.client.email,callback:function(e){t.$set(t.client,"email",e)},expression:"client.email"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md3:"","offset-md1":""}},[i("v-text-field",{attrs:{label:"Телефон",required:"",mask:"phone",color:"green lighten-1"},model:{value:t.client.phone,callback:function(e){t.$set(t.client,"phone",e)},expression:"client.phone"}})],1),t._v(" "),i("v-flex",{attrs:{xs12:"",md2:"","offset-md10":""}},[i("v-btn",{attrs:{block:"",color:"md-add-item-btn green lighten-1"},nativeOn:{click:function(e){t.saveClient(t.client)}}},[t._v("Сохранить")])],1)],1)],1)},a=[],s={render:n,staticRenderFns:a};e.a=s},iZiO:function(t,e,i){"use strict";var n=i("D+jH"),a=i("qk08"),s=i("uc2u"),l=i("K/lz");e.a={props:["budgetCreation","clients","budgets","saveBudget","saveClient","budget","client","updateClient","fixClientNameAndUpdate","editPage","budgetEdit"],components:{"budget-creation":n.a,"client-creation":a.a,"budget-edit":s.a,"client-edit":l.a}}},l4QF:function(t,e){},lnzh:function(t,e,i){"use strict";e.a={props:["saveClient"],data:function(){return{client:{name:null,email:null,phone:null}}}}},m1TP:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"l-list-body"},[t._l(t.data,function(e){return null!=t.data&&null===t.parsedBudgets?i("div",{staticClass:"md-list-item"},[t._l(e,function(n){return n!=e._id&&n!=e.client_id?i("div",{class:t.budgetsVisible?"md-budget-info white--text":"md-client-info white--text"},[t._v("\n      "+t._s(n)+"\n    ")]):t._e()}),t._v(" "),i("div",{class:t.budgetsVisible?"l-budget-actions white--text":"l-client-actions white--text"},[i("v-btn",{attrs:{small:"",flat:"",color:"yellow accent-1"},nativeOn:{click:function(i){t.getItemAndEdit(e)}}},[i("v-icon",[t._v("mode_edit")])],1),t._v(" "),i("v-btn",{attrs:{small:"",flat:"",color:"red lighten-1"},nativeOn:{click:function(i){t.deleteItem(e,t.data,t.budgetsVisible)}}},[i("v-icon",[t._v("delete_forever")])],1)],1)],2):t._e()}),t._v(" "),t._l(t.parsedBudgets,function(e){return null!==t.parsedBudgets?i("div",{staticClass:"md-list-item"},[t._l(e,function(n){return n!=e._id&&n!=e.client_id?i("div",{class:t.budgetsVisible?"md-budget-info white--text":"md-client-info white--text"},[t._v("\n      "+t._s(n)+"\n    ")]):t._e()}),t._v(" "),i("div",{class:t.budgetsVisible?"l-budget-actions white--text":"l-client-actions white--text"},[i("v-btn",{attrs:{small:"",flat:"",color:"yellow accent-1"},nativeOn:{click:function(i){t.getItemAndEdit(e)}}},[i("v-icon",[t._v("mode_edit")])],1),t._v(" "),i("v-btn",{attrs:{small:"",flat:"",color:"red lighten-1"},nativeOn:{click:function(i){t.deleteItem(e,t.data,t.budgetsVisible)}}},[i("v-icon",[t._v("delete_forever")])],1)],1)],2):t._e()})],2)},a=[],s={render:n,staticRenderFns:a};e.a=s},qk08:function(t,e,i){"use strict";function n(t){i("l4QF")}var a=i("lnzh"),s=i("i1Wc"),l=i("VU/8"),r=n,c=l(a.a,s.a,!1,r,null,null);e.a=c.exports},teIl:function(t,e,i){"use strict";function n(t){i("5UxW")}var a=i("HCTz"),s=i("g0Ki"),l=i("VU/8"),r=n,c=l(a.a,s.a,!1,r,null,null);e.a=c.exports},u32G:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"l-create-page"},[t.budgetCreation&&!t.editPage?i("budget-creation",{attrs:{slot:"budget-creation",clients:t.clients,budgets:t.budgets,saveBudget:t.saveBudget},slot:"budget-creation"}):t._e(),t._v(" "),t.budgetCreation||t.editPage?t.budgetEdit&&t.editPage?i("budget-edit",{attrs:{slot:"budget-creation",clients:t.clients,budgets:t.budgets,selectedBudget:t.budget,fixClientNameAndUpdate:t.fixClientNameAndUpdate},slot:"budget-creation"}):!t.budgetEdit&&t.editPage?i("client-edit",{attrs:{slot:"client-creation",selectedClient:t.client,updateClient:t.updateClient},slot:"client-creation"}):t._e():i("client-creation",{attrs:{slot:"client-creation",saveClient:t.saveClient},slot:"client-creation"})],1)},a=[],s={render:n,staticRenderFns:a};e.a=s},u4bJ:function(t,e){},uRV1:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"l-auth-container"},[i("div",{staticClass:"l-auth"},[i("v-form",{model:{value:t.validLogin,callback:function(e){t.validLogin=e},expression:"validLogin"}},[i("v-text-field",{attrs:{label:"Логин","prepend-icon":"account_box",rules:t.rules,required:"",color:"light-blue lighten-1"},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username",e)},expression:"credentials.username"}}),t._v(" "),i("v-text-field",{attrs:{label:"Пароль","prepend-icon":"lock",rules:t.rules,"append-icon":t.loginPasswordVisible?"visibility":"visibility_off","append-icon-cb":function(){return t.loginPasswordVisible=!t.loginPasswordVisible},type:t.loginPasswordVisible?"text":"password",color:"light-blue lighten-1",required:""},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}}),t._v(" "),i("v-btn",{attrs:{block:"",flat:"",color:"light-blue lighten-1"},nativeOn:{click:function(e){t.signUpVisible=!0}}},[t._v("Создать")]),t._v(" "),i("v-btn",{attrs:{block:"",color:"light-blue lighten-1"},nativeOn:{click:function(e){t.submitAuthentication()}}},[t._v("Войти")])],1)],1),t._v(" "),t.signUpVisible?i("div",{staticClass:"l-signup"},[i("v-form",{model:{value:t.validSignUp,callback:function(e){t.validSignUp=e},expression:"validSignUp"}},[i("v-text-field",{attrs:{label:"Логин","prepend-icon":"account_box",rules:t.rules,required:"",color:"light-blue lighten-1"},model:{value:t.newUser.username,callback:function(e){t.$set(t.newUser,"username",e)},expression:"newUser.username"}}),t._v(" "),i("v-text-field",{attrs:{label:"Пароль","prepend-icon":"lock",rules:t.rules,"append-icon":t.signUpPasswordVisible?"visibility":"visibility_off","append-icon-cb":function(){return t.signUpPasswordVisible=!t.signUpPasswordVisible},type:t.signUpPasswordVisible?"text":"password",color:"light-blue lighten-1",required:""},model:{value:t.newUser.password,callback:function(e){t.$set(t.newUser,"password",e)},expression:"newUser.password"}}),t._v(" "),i("v-btn",{attrs:{block:"",color:"light-blue lighten-1"},nativeOn:{click:function(e){t.submitSignUp()}}},[t._v("Регистрация")])],1)],1):t._e(),t._v(" "),i("v-snackbar",{attrs:{timeout:t.timeout,bottom:"bottom",color:"red lighten-1"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n    "+t._s(t.message)+"\n  ")])],1)},a=[],s={render:n,staticRenderFns:a};e.a=s},uc2u:function(t,e,i){"use strict";function n(t){i("A2gB")}var a=i("eCfQ"),s=i("7NQB"),l=i("VU/8"),r=n,c=l(a.a,s.a,!1,r,null,null);e.a=c.exports},w20z:function(t,e,i){"use strict";e.a={props:["updateClient","selectedClient"],data:function(){return{client:{name:null,email:null,phone:null}}},mounted:function(){this.client=this.selectedClient}}},wWYc:function(t,e,i){"use strict";var n=i("heOt"),a=i("aVU9"),s=i("VU/8"),l=s(n.a,a.a,!1,null,null,null);e.a=l.exports},xJD8:function(t,e,i){"use strict";e.a={name:"app",data:function(){return{}}}}},["NHnr"]);
//# sourceMappingURL=app.835579a6e1748bdb0bb7.js.map